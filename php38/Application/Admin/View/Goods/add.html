<!--//导入layout.html-->
<layout name="layout"/>
<!--在线编辑器-->
<link href="__PUBLIC__/umeditor1_2_2-utf8-php/themes/default/css/umeditor.css" type="text/css" rel="stylesheet">
<script type="text/javascript" src="__PUBLIC__/umeditor1_2_2-utf8-php/third-party/jquery.min.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor1_2_2-utf8-php/umeditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor1_2_2-utf8-php/umeditor.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/umeditor1_2_2-utf8-php/lang/zh-cn/zh-cn.js"></script>
<div class="tab-div">
    <div id="tabbar-div">
        <p>
            <span class="tab-front">基本信息</span>
            <span class="tab-back">会员价格</span>
            <span class="tab-back">商品属性</span>
            <span class="tab-back">商品相册</span>
        </p>
    </div>
    <div id="tabbody-div">
        <form enctype="multipart/form-data" action="__SELF__" method="post">
            <!--基本信息-->
            <table width="90%" class="table_form"  align="center">
                <tr>
                    <td class="label">主分类：</td>
                    <td>
                        <select name="cat_id" >
                            <option value="">选择分类</option>
                            <?php foreach ($cateData as $k => $v):?>
                            <option value="<?php echo $v['id']?>"><?php echo str_repeat('-',$v['level']*8).$v['cat_name'];?></option>
                            <?php endforeach;?>
                        </select>
                        <span class="require-field">*</span>
                    </td>
                </tr>
                <tr>
                    <td class="label">扩展分类：</td>
    ·                   <td>
                            <ul>
                                <li>
                                    <input type="button" value="[+]" onclick="add_li(this)">
                                    <select name="ext_cat_id[]" >
                                        <option value="">选择分类</option>
                                        <?php foreach ($cateData as $k => $v):?>
                                        <option value="<?php echo $v['id']?>"><?php echo str_repeat('-',$v['level']*8).$v['cat_name'];?></option>
                                        <?php endforeach;?>
                                    </select>
                                </li>
                            </ul>
                    </td>
                </tr>
                <tr>
                    <td class="label">商品名称：</td>
                    <td><input type="text" name="goods_name" value=""size="30" />
                        <span class="require-field">*</span></td>
                </tr>
                <tr>
                    <td class="label">市场售价：</td>
                    <td>
                        <input type="text" name="market_price" value="0" size="20"/>
                        <span class="require-field">*</span>
                    </td>
                </tr>
                <tr>
                    <td class="label">本店售价：</td>
                    <td>
                        <input type="text" name="shop_price" value="0" size="20"/>
                        <span class="require-field">*</span>
                    </td>
                </tr>
                <tr>
                    <td class="label">是否上架：</td>
                    <td>
                        <input type="radio" name="is_on_sale" value="是" checked="checked"/>是
                        <input type="radio" name="is_on_sale" value="否"/>否
                    </td>
                </tr>
                <tr>
                    <td class="label">商品图片：</td>
                    <td>
                        <input type="file" name="logo"  />
                    </td>
                </tr>
                <tr>
                    <td class="label">商品简单描述：</td>
                    <td>
                        <textarea id="goods_desc" name="goods_desc" cols="40" rows="3"></textarea>
                    </td>
                </tr>
            </table>
            <!-- 会员价格 -->
            <table style="display:none;" width="90%" class="table_form" align="center">
                <tr><td colspan="2" style="color:#F00;font-size:20px;font-weight:bold;padding:10px;">说明：如果指定了价格就使用这个价格，如果没有指定价格就按这个级别的折扣率来计算</td></tr>
                <?php foreach ($mlData as $k => $v): ?>
                <tr>
                    <td width="150"><?php echo $v['level_name']; ?>【<?php echo $v['level_rate']/10; ?>折】 ：</td>
                    <td>
                        ￥<input type="text" name="member_price[]" />元
                        <input type="hidden" name="level_id[]" value="<?php echo $v['id']; ?>" />
                    </td>
                </tr>
                <?php endforeach; ?>
            </table>
            <!-- 商品属性 -->
            <table style="display:none;" width="90%" class="table_form" align="center">
                <tr>
                    <td>商品类型：</td>
                </tr>
                <tr><td><ul id="attr_list"></ul></td></tr>
            </table>
            <!-- 相册 -->
            <table style="display:none;" width="90%" class="table_form" align="center">
                <tr>
                    <td class="label"><input onclick="$('#pic_ul').append( $('#pic_ul').find('li:eq(0)').clone()  );" type="button" value="添加一张图片" /></td>
                    <td>
                        <ul id="pic_ul">
                            <li><input type="file" name="pic[]" /></li>
                        </ul>
                    </td>
                </tr>
            </table>
            <div class="button-div">
                <input type="submit" value=" 确定 " class="button"/>
                <input type="reset" value=" 重置 " class="button" />
            </div>
        </form>
    </div>
</div>
<script>
    UM.getEditor('goods_desc',{
        initialFrameWidth:'50%',
        initialFrameHeight:200
    });

   function add_li(btn){
       if($(btn).val() == '[+]'){
           //先获取所在的ui标签
           var ul=$(btn).parents('ul');
           //把按钮所在的li吉隆一份,放到ui中
           var newli=$(btn).parent().clone();
           //把+变-
           newli.find(":button").val('[-]');
           ul.append(newli);
       }else{
           $(btn).parent().remove();
       }
   }
    $("#tabbar-div p span").click(function(){
        // 点击的是第几个按钮
        var i = $(this).index();
        // 显示第i个table
        $(".table_form").hide().eq(i).show();
        $(".tab-front").removeClass("tab-front").addClass("tab-back");
        $(this).addClass("tab-front").removeClass("tab-back");
    });
</script>